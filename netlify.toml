# Netlify Deploy Configuration
#
# This site is the Astro-based frontend only.
# The cis118m-dotnet-runner backend should be deployed separately.
#
# Proxy configuration: Editor calls /api/* which routes to Netlify Function
# that forwards to the deployed runner with authentication.

[build]
  command = "npm run build"
  publish = "dist"

[dev]
  command = "npm run dev"
  targetPort = 4321
  port = 8888

# Netlify Functions configuration
[functions]
  directory = "netlify/functions"
  node_bundler = "esbuild"

# Route /api/* to the runner-proxy function
[[redirects]]
  from = "/api/*"
  to = "/.netlify/functions/runner-proxy"
  status = 200
  force = true

# Environment variables needed in Netlify dashboard:
# - RUNNER_URL: https://cis118m-dotnet-course-site-astro.onrender.com
# - RUNNER_KEY: A secret key that the runner will validate
# - Do NOT set PUBLIC_RUNNER_URL (leave empty)

